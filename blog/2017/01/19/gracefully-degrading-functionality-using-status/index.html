<!DOCTYPE html><html lang="en" data-astro-cid-bvzihdzo> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.4.4"><!-- Font preloads --><link rel="preload" href="/fonts/atkinson-regular.woff" as="font" type="font/woff" crossorigin><link rel="preload" href="/fonts/atkinson-bold.woff" as="font" type="font/woff" crossorigin><!-- Canonical URL --><link rel="canonical" href="https://engineering.indeedblog.com/blog/2017/01/degrade-functionality/"><!-- Primary Meta Tags --><title>Gracefully Degrading Functionality Using Status | Mya Jaye</title><meta name="title" content="Gracefully Degrading Functionality Using Status | Mya Jaye"><meta name="description" content=""><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://mya.sh/blog/2017/01/19/gracefully-degrading-functionality-using-status/"><meta property="og:title" content="Gracefully Degrading Functionality Using Status | Mya Jaye"><meta property="og:description" content=""><meta property="og:image" content="https://mya.sh/blog-placeholder-1.jpg"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://mya.sh/blog/2017/01/19/gracefully-degrading-functionality-using-status/"><meta property="twitter:title" content="Gracefully Degrading Functionality Using Status | Mya Jaye"><meta property="twitter:description" content=""><meta property="twitter:image" content="https://mya.sh/blog-placeholder-1.jpg"><link rel="stylesheet" href="/_astro/_slug_.g_98uJJA.css" />
<style>main[data-astro-cid-bvzihdzo]{width:960px;max-width:calc(100% - 2em);margin:0 auto}div[data-astro-cid-bvzihdzo].prose{width:800px;max-width:calc(100% - 2em);margin:2em auto 0;color:var(--color-text)}.hero-image[data-astro-cid-bvzihdzo]{margin-top:30px;width:100%}.hero-image[data-astro-cid-bvzihdzo] img[data-astro-cid-bvzihdzo]{display:block;margin:0 auto;border-radius:12px;box-shadow:var(--box-shadow)}.title[data-astro-cid-bvzihdzo]{margin:2em 0 1em;padding:1em 0;text-align:center;line-height:1}.title[data-astro-cid-bvzihdzo] h1[data-astro-cid-bvzihdzo]{margin:0 0 .5em}.date[data-astro-cid-bvzihdzo]{margin-bottom:.5em;color:var(--color-text)}.last-updated-on[data-astro-cid-bvzihdzo]{font-style:italic}footer[data-astro-cid-bvzihdzo]{padding:2em 1em 6em;color:var(--color-text);text-align:center}.light-dark[data-astro-cid-bvzihdzo]{position:fixed;top:0;left:0;padding:10px}
</style><script type="module">const t=document.querySelector('.theme-switch input[type="checkbox"]'),e=localStorage.getItem("theme");e&&(document.documentElement.setAttribute("data-theme",e),e==="dark"&&(t.checked=!0));function m(c){c.target.checked?(document.documentElement.setAttribute("data-theme","dark"),localStorage.setItem("theme","dark")):(document.documentElement.setAttribute("data-theme","light"),localStorage.setItem("theme","light"))}t.addEventListener("change",m,!1);
</script></head> <body data-astro-cid-bvzihdzo> <div class="light-dark" data-astro-cid-bvzihdzo> <div class="theme-switch-wrapper"> <label class="theme-switch" for="checkbox"> <input type="checkbox" id="checkbox"> <div class="slider"> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="#FCD53F" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"> <circle cx="12" cy="12" r="5"></circle> <line x1="12" y1="1" x2="12" y2="3"></line> <line x1="12" y1="21" x2="12" y2="23"></line> <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line> <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line> <line x1="1" y1="12" x2="3" y2="12"></line> <line x1="21" y1="12" x2="23" y2="12"></line> <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line> <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line> </svg> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="#FCD53F" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"> <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path> </svg> </div> </label>  </div> </div> <main data-astro-cid-bvzihdzo> <div class="social-links" data-astro-cid-yxtifmrq> <a href="https://linktr.ee/MsMyaDev" target="_blank" data-astro-cid-yxtifmrq> <span class="sr-only" data-astro-cid-yxtifmrq>Linktree</span> <svg viewBox="0 0 24 24" aria-hidden="true" width="32" height="32" data-astro-cid-yxtifmrq> <path fill="currentColor" d="M7.953 15.066c-.08.163-.08.324-.08.486.08.517.528.897 1.052.89h1.294v4.776c0 .486-.404.89-.89.89H6.577a.898.898 0 0 1-.889-.891v-4.774H.992c-.728 0-1.214-.729-.89-1.377l6.96-12.627a1.065 1.065 0 0 1 1.863 0l2.913 5.585-3.885 7.042zm15.945 0-6.96-12.627a1.065 1.065 0 0 0-1.862 0l-2.995 5.586 3.885 7.04c.081.164.081.326.081.487-.08.517-.529.897-1.052.89h-1.296v4.776c.005.49.4.887.89.89h2.914a.9.9 0 0 0 .892-.89v-4.775h4.612c.73 0 1.214-.729.89-1.377z" data-astro-cid-yxtifmrq></path> </svg> </a> <a href="https://github.com/mjpitz" target="_blank" data-astro-cid-yxtifmrq> <span class="sr-only" data-astro-cid-yxtifmrq>GitHub</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-yxtifmrq> <path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-yxtifmrq></path> </svg> </a> <a href="https://www.linkedin.com/in/mjpitz/" target="_blank" data-astro-cid-yxtifmrq> <span class="sr-only" data-astro-cid-yxtifmrq>LinkedIn</span> <svg viewBox="0 0 50 50" aria-hidden="true" width="32" height="32" data-astro-cid-yxtifmrq> <path fill="currentColor" d="M41,4H9C6.24,4,4,6.24,4,9v32c0,2.76,2.24,5,5,5h32c2.76,0,5-2.24,5-5V9C46,6.24,43.76,4,41,4z M17,20v19h-6V20H17z M11,14.47c0-1.4,1.2-2.47,3-2.47s2.93,1.07,3,2.47c0,1.4-1.12,2.53-3,2.53C12.2,17,11,15.87,11,14.47z M39,39h-6c0,0,0-9.26,0-10 c0-2-1-4-3.5-4.04h-0.08C27,24.96,26,27.02,26,29c0,0.91,0,10,0,10h-6V20h6v2.56c0,0,1.93-2.56,5.81-2.56 c3.97,0,7.19,2.73,7.19,8.26V39z" data-astro-cid-yxtifmrq></path> </svg> </a> <a href="https://twitter.com/MsMyaDev/" target="_blank" data-astro-cid-yxtifmrq> <span class="sr-only" data-astro-cid-yxtifmrq>Twitter</span> <svg viewBox="0 0 310 310" width="32" height="32" data-astro-cid-yxtifmrq> <path fill="currentColor" d="M302.973,57.388c-4.87,2.16-9.877,3.983-14.993,5.463c6.057-6.85,10.675-14.91,13.494-23.73 c0.632-1.977-0.023-4.141-1.648-5.434c-1.623-1.294-3.878-1.449-5.665-0.39c-10.865,6.444-22.587,11.075-34.878,13.783 c-12.381-12.098-29.197-18.983-46.581-18.983c-36.695,0-66.549,29.853-66.549,66.547c0,2.89,0.183,5.764,0.545,8.598 C101.163,99.244,58.83,76.863,29.76,41.204c-1.036-1.271-2.632-1.956-4.266-1.825c-1.635,0.128-3.104,1.05-3.93,2.467 c-5.896,10.117-9.013,21.688-9.013,33.461c0,16.035,5.725,31.249,15.838,43.137c-3.075-1.065-6.059-2.396-8.907-3.977 c-1.529-0.851-3.395-0.838-4.914,0.033c-1.52,0.871-2.473,2.473-2.513,4.224c-0.007,0.295-0.007,0.59-0.007,0.889 c0,23.935,12.882,45.484,32.577,57.229c-1.692-0.169-3.383-0.414-5.063-0.735c-1.732-0.331-3.513,0.276-4.681,1.597 c-1.17,1.32-1.557,3.16-1.018,4.84c7.29,22.76,26.059,39.501,48.749,44.605c-18.819,11.787-40.34,17.961-62.932,17.961 c-4.714,0-9.455-0.277-14.095-0.826c-2.305-0.274-4.509,1.087-5.294,3.279c-0.785,2.193,0.047,4.638,2.008,5.895 c29.023,18.609,62.582,28.445,97.047,28.445c67.754,0,110.139-31.95,133.764-58.753c29.46-33.421,46.356-77.658,46.356-121.367 c0-1.826-0.028-3.67-0.084-5.508c11.623-8.757,21.63-19.355,29.773-31.536c1.237-1.85,1.103-4.295-0.33-5.998 C307.394,57.037,305.009,56.486,302.973,57.388z" data-astro-cid-yxtifmrq></path> </svg> </a> <a href="https://youtube.com/@Ms-Mya-Dev/" target="_blank" data-astro-cid-yxtifmrq> <span class="sr-only" data-astro-cid-yxtifmrq>YouTube</span> <svg viewBox="0 0 310 310" width="32" height="32" data-astro-cid-yxtifmrq> <g data-astro-cid-yxtifmrq> <path fill="currentColor" d="M297.917,64.645c-11.19-13.302-31.85-18.728-71.306-18.728H83.386c-40.359,0-61.369,5.776-72.517,19.938   C0,79.663,0,100.008,0,128.166v53.669c0,54.551,12.896,82.248,83.386,82.248h143.226c34.216,0,53.176-4.788,65.442-16.527   C304.633,235.518,310,215.863,310,181.835v-53.669C310,98.471,309.159,78.006,297.917,64.645z M199.021,162.41l-65.038,33.991   c-1.454,0.76-3.044,1.137-4.632,1.137c-1.798,0-3.592-0.484-5.181-1.446c-2.992-1.813-4.819-5.056-4.819-8.554v-67.764   c0-3.492,1.822-6.732,4.808-8.546c2.987-1.814,6.702-1.938,9.801-0.328l65.038,33.772c3.309,1.718,5.387,5.134,5.392,8.861   C204.394,157.263,202.325,160.684,199.021,162.41z" data-astro-cid-yxtifmrq></path> </g> </svg> </a> <a href="/rss.xml" target="_blank" data-astro-cid-yxtifmrq> <span class="sr-only" data-astro-cid-yxtifmrq>RSS</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-yxtifmrq> <path fill="currentColor" d="M1,5v2c1.081,0,2.128,0.211,3.113,0.628c0.952,0.403,1.808,0.98,2.543,1.715s1.312,1.591,1.715,2.543 C8.789,12.872,9,13.919,9,15h2C11,9.477,6.523,5,1,5z M4,10c-1.105,0-2,0.895-2,2s0.895,2,2,2s2-0.895,2-2S5.105,10,4,10z M1,1v2 c1.621,0,3.192,0.317,4.67,0.942c1.429,0.604,2.712,1.47,3.815,2.573c1.103,1.103,1.968,2.386,2.573,3.815 C12.683,11.808,13,13.379,13,15h2C15,7.268,8.732,1,1,1z" data-astro-cid-yxtifmrq></path> </svg> </a> </div>  <nav data-astro-cid-pux6a34n> <div class="internal-links" data-astro-cid-pux6a34n> <a href="/" data-astro-cid-pux6a34n data-astro-cid-eimmu3lg> About </a>  <a href="/blog" class="active" data-astro-cid-pux6a34n data-astro-cid-eimmu3lg> Blog </a>  <a href="/charts" data-astro-cid-pux6a34n data-astro-cid-eimmu3lg> Charts </a>  <a href="/media" data-astro-cid-pux6a34n data-astro-cid-eimmu3lg> Media </a>  <a href="/collab" data-astro-cid-pux6a34n data-astro-cid-eimmu3lg> Collaborate </a>  </div> </nav>  <div class="hero-image" data-astro-cid-bvzihdzo> <img width="1020" height="510" src="/img/blog-placeholder-5.jpg" alt="" data-astro-cid-bvzihdzo> </div> <div class="title" data-astro-cid-bvzihdzo> <div class="date" data-astro-cid-bvzihdzo> <time datetime="2017-01-19T00:00:00.000Z"> Jan 19, 2017 </time>  </div>  <h1 data-astro-cid-bvzihdzo>Gracefully Degrading Functionality Using Status</h1> <hr data-astro-cid-bvzihdzo> </div> <div class="prose" data-astro-cid-bvzihdzo>  <p>In a previous <a href="/blog/2015/07/10/status-java-library-for-system-status-health-checks/">blog post</a>, we described how to use our <a href="https://github.com/indeedeng/status">Status</a> library to create a robust health check for your applications.
In this follow-up, we show how you can check and degrade your application during an outage by:</p>
<ul>
<li>short-circuiting code paths of your application</li>
<li>removing a single application instance from a data center load balancer</li>
<li>removing an entire data center from rotation at the DNS level</li>
</ul>
<!--more-->
<p>Evaluating application health
The Status library allows you to perform two different types of checks on a system — a single dependency check and a system-wide evaluation. A dependency is a system or service that your system requires in order to function.</p>
<p>During a single dependency check, the <a href="https://github.com/indeedeng/status/blob/master/status-core/src/main/java/com/indeed/status/core/AbstractDependencyManager.java">AbstractDependencyManager</a> uses an evaluate method that takes the dependency’s ID and returns a <a href="https://github.com/indeedeng/status/blob/master/status-core/src/main/java/com/indeed/status/core/CheckResult.java">CheckResult</a>.</p>
<p>A <code>CheckResult</code> includes:</p>
<ul>
<li>the health of the dependency</li>
<li>some basic information about the dependency</li>
<li>the time it took to evaluate the health of the dependency</li>
</ul>
<p>A CheckResult is a Java enum that is one of <code>OK</code>, <code>MINOR</code>, <code>MAJOR</code>, or <code>OUTAGE</code>.
The <code>OUTAGE</code> status indicates that the dependency is not usable.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">final</span><span style="color:#E1E4E8"> CheckResult checkResult </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dependencyManager.</span><span style="color:#B392F0">evaluate</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"dependencyId"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"><span style="color:#F97583">final</span><span style="color:#E1E4E8"> CheckStatus status </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> checkResult.</span><span style="color:#B392F0">getStatus</span><span style="color:#E1E4E8">();</span></span></code></pre>
<p>The second approach to evaluating an application’s health is to look at the system as a whole.
This gives you a high-level overview of how the entire system is performing.
When a system is in <code>OUTAGE</code>, this indicates that the instance of an application is not usable.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">final</span><span style="color:#E1E4E8"> CheckResultSet checkResultSet </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dependencyManager.</span><span style="color:#B392F0">evaluate</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#F97583">final</span><span style="color:#E1E4E8"> CheckStatus systemStatus </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> checkResultSet.</span><span style="color:#B392F0">getSystemStatus</span><span style="color:#E1E4E8">();</span></span></code></pre>
<p>If a system is unhealthy, it’s often best to short circuit requests made to the system and return an HTTP status code 500 (“Internal Server Error”).
In the example below, we use an interceptor in Spring to capture the request, evaluate the system’s health, and respond with an error in the event that the application is in an outage.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F97583">public</span><span style="color:#F97583"> class</span><span style="color:#B392F0"> SystemHealthInterceptor</span><span style="color:#F97583"> extends</span><span style="color:#B392F0"> HandlerInterceptorAdapter</span><span style="color:#E1E4E8"> {</span></span>
<span class="line"><span style="color:#F97583">    private</span><span style="color:#F97583"> final</span><span style="color:#E1E4E8"> DependencyManager dependencyManager;</span></span>
<span class="line"><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#E1E4E8">    @</span><span style="color:#F97583">Override</span></span>
<span class="line"><span style="color:#F97583">    public</span><span style="color:#F97583"> boolean</span><span style="color:#B392F0"> preHandle</span><span style="color:#E1E4E8">(</span></span>
<span class="line"><span style="color:#F97583">            final</span><span style="color:#E1E4E8"> HttpServletRequest </span><span style="color:#FFAB70">request</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">            final</span><span style="color:#E1E4E8"> HttpServletResponse </span><span style="color:#FFAB70">response</span><span style="color:#E1E4E8">,</span></span>
<span class="line"><span style="color:#F97583">            final</span><span style="color:#E1E4E8"> Object </span><span style="color:#FFAB70">handler</span></span>
<span class="line"><span style="color:#E1E4E8">    ) </span><span style="color:#F97583">throws</span><span style="color:#E1E4E8"> Exception {</span></span>
<span class="line"><span style="color:#F97583">        final</span><span style="color:#E1E4E8"> CheckResultSet checkResultSet </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> dependencyManager.</span><span style="color:#B392F0">evaluate</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#F97583">        final</span><span style="color:#E1E4E8"> CheckStatus systemStatus </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> checkResultSet.</span><span style="color:#B392F0">getSystemStatus</span><span style="color:#E1E4E8">();</span></span>
<span class="line"><span style="color:#E1E4E8">         </span></span>
<span class="line"><span style="color:#F97583">        switch</span><span style="color:#E1E4E8"> (systemStatus) {</span></span>
<span class="line"><span style="color:#F97583">            case</span><span style="color:#E1E4E8"> OUTAGE</span><span style="color:#F97583">:</span></span>
<span class="line"><span style="color:#E1E4E8">                response.</span><span style="color:#B392F0">setStatus</span><span style="color:#E1E4E8">(HttpStatus.INTERNAL_SERVER_ERROR.</span><span style="color:#B392F0">value</span><span style="color:#E1E4E8">());</span></span>
<span class="line"><span style="color:#F97583">                return</span><span style="color:#79B8FF"> false</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">            default:</span></span>
<span class="line"><span style="color:#F97583">                break</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">        }</span></span>
<span class="line"><span style="color:#E1E4E8"> </span></span>
<span class="line"><span style="color:#F97583">        return</span><span style="color:#79B8FF"> true</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#E1E4E8">    }</span></span>
<span class="line"><span style="color:#E1E4E8">}</span></span></code></pre>
<h2 id="comparing-the-health-of-dependencies">Comparing the health of dependencies</h2>
<p><a href="https://github.com/indeedeng/status/blob/master/status-core/src/main/java/com/indeed/status/core/CheckResultSet.java">CheckResultSet</a> and <a href="https://github.com/indeedeng/status/blob/master/status-core/src/main/java/com/indeed/status/core/CheckResult.java">CheckResult</a> have methods for returning the current status of the system or the dependency, respectively.
Once you have CheckStatus, there are a couple of methods that allow you to compare the results.</p>
<p><code>isBetterThan()</code> determines if the current status is better than the provided status. This is an exclusive comparison.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">CheckStatus.OK.</span><span style="color:#B392F0">isBetterThan</span><span style="color:#E1E4E8">(CheckStatus.OK)              </span><span style="color:#6A737D">// evaluates to false</span></span>
<span class="line"><span style="color:#E1E4E8">CheckStatus.OK.</span><span style="color:#B392F0">isBetterThan</span><span style="color:#E1E4E8">(</span><span style="color:#6A737D">/* any other CheckStatus */</span><span style="color:#E1E4E8">) </span><span style="color:#6A737D">// evaluates to true</span></span></code></pre>
<p><code>isWorseThan()</code> determines if the current status is worse than the provided status. Again, this operation is exclusive.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">CheckStatus.OUTAGE.</span><span style="color:#B392F0">isWorseThan</span><span style="color:#E1E4E8">(CheckStatus.OUTAGE)          </span><span style="color:#6A737D">// evaluates to false</span></span>
<span class="line"><span style="color:#E1E4E8">CheckStatus.OUTAGE.</span><span style="color:#B392F0">isWorseThan</span><span style="color:#E1E4E8">(</span><span style="color:#6A737D">/* any other CheckStatus */</span><span style="color:#E1E4E8">) </span><span style="color:#6A737D">// evaluates to true</span></span></code></pre>
<p>The <code>isBetterThan()</code> and <code>isWorseThan()</code> methods are great tools to check for a desired state of an evaluated dependency.
Unfortunately, these methods do not offer enough control to produce a graceful degradation.
Either the system was healthy, or it was in an outage.
To better control the graceful degradation of our system, two additional methods were needed.</p>
<p><code>noBetterThan()</code> returns the unhealthier of the two statuses.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">CheckStatus.MINOR.</span><span style="color:#B392F0">noBetterThan</span><span style="color:#E1E4E8">(CheckStatus.MAJOR) </span><span style="color:#6A737D">// returns CheckStatus.MAJOR</span></span>
<span class="line"><span style="color:#E1E4E8">CheckStatus.MINOR.</span><span style="color:#B392F0">noBetterThan</span><span style="color:#E1E4E8">(CheckStatus.OK)    </span><span style="color:#6A737D">// returns CheckStatus.MINOR</span></span></code></pre>
<p><code>noWorseThan()</code> returns the healthier of the two statuses.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#E1E4E8">CheckStatus.MINOR.</span><span style="color:#B392F0">noWorseThan</span><span style="color:#E1E4E8">(CheckStatus.MAJOR) </span><span style="color:#6A737D">// returns CheckStatus.MINOR</span></span>
<span class="line"><span style="color:#E1E4E8">CheckStatus.MINOR.</span><span style="color:#B392F0">noWorseThan</span><span style="color:#E1E4E8">(CheckStatus.OK)    </span><span style="color:#6A737D">// returns CheckStatus.OK</span></span></code></pre>
<p>During the complete system evaluation, we use a combination of these methods and the <code>Urgency#downgradeWith()</code> methods to gracefully degrade our application’s health.</p>
<p>By having the ability to inspect the outage state, engineers can dynamically toggle feature visibility based on the health of its corresponding dependency.
Suppose that our service that provides company information was unable to reach its database.
The service’s health check would change its state to MAJOR or OUTAGE.
Our job search product would then omit the company widget from the right rail on the search results page.
The core functionality that helps people find jobs would be unaffected.</p>
<p><strong>Healthy</strong></p>
<p><img src="/img/2017-status-healthy.png" alt="healthy"></p>
<p><strong>Unhealthy (Gracefully)</strong></p>
<p><img src="/img/2017-status-unhealthy.png" alt="gracefully unhealthy"></p>
<p>Status offers more than just the ability to control features based on a service’s health.
We also use it to control access to instances of our front end web applications.
When an instance is unable to service requests, we remove it from the load balancer until it is healthy again.</p>
<h2 id="instance-level-failovers">Instance level failovers</h2>
<p>Generally, running multiple instances of your application in production is highly recommended.
This helps keep your system resilient by allowing it to continue to handle requests even if a single instance of your application crashes.
These instances of your application can live on a single machine, multiple machines, and even in multiple data centers.</p>
<p>The Status library lets you configure your load balancer to remove an instance if it becomes unhealthy.
Consider the following basic example within a single data center.</p>
<p><img src="/img/2017-status-all-healthy.png" alt="all healthy"></p>
<p><em>When all of the applications within a single data center are healthy, the load balancer distributes requests among them evenly. To determine if an application is healthy, the load balancer sends a request to the health check endpoint and evaluates the response code.</em></p>
<p><img src="/img/2017-status-one-unhealthy.png" alt="one unhealthy"></p>
<p><em>When an instance becomes unhealthy, the health check endpoint returns a non-200 status code, indicating that it should no longer receive traffic. The load balancer then removes the unhealthy instance from rotation, preventing it from receiving requests.</em></p>
<p><img src="/img/2017-status-one-removed.png" alt="one removed"></p>
<p><em>When instance 1 is removed from rotation, the other instances within a data center start to receive instance 1’s traffic. Within each data center, we provision enough instances so that we can handle traffic even if some of the instances go down.</em></p>
<h2 id="data-center-level-failovers">Data center level failovers</h2>
<p>Before a request is even sent to a data center, our domain (e.g. <a href="http://www.indeed.com">www.indeed.com</a>) is resolved to an IP address using DNS. We use Global Server Load Balancer (GSLB) that allows us to geographically distribute traffic across our data centers. After the GSLB resolves the domain to the IP address of the nearest available data center, the data center load balancer then routes and fails over traffic as described above.</p>
<p><img src="/img/2017-status-dc-healthy.png" alt="healthy"></p>
<p>What if an entire data center can no longer service requests? Similar to the single instance approach, GSLB constantly checks each of our data centers for their health (using the same health check endpoint). When GSLB detects that a single data center can no longer service requests, it fails requests over to another data center and removes the unhealthy data center from rotation. Again, this helps keep the site available by ensuring that requests can be processed, even during an outage.</p>
<p><img src="/img/2017-status-dc-removed.png" alt="failout"></p>
<p>As long as a single data center remains healthy, the site can continue to service requests. For users that hit unhealthy data centers, this just looks like a slower web page load. While not ideal, the experience is better than an unprocessed request.</p>
<p>The last scenario is a complete system outage. This occurs when every data center becomes unhealthy and can no longer service requests. Engineers try to avoid this situation like the plague.</p>
<p><img src="/img/2017-status-all-dc-removed.png" alt="failopen"></p>
<p>When Indeed encounters complete system outages, we reroute traffic to every data center and every instance. This policy, known as “failing open,” allows for graceful degradation of our system. While every instance may report an unhealthy state, it is possible that an application can perform some work. And being able to perform some work is better than performing no work.</p>
<h2 id="status-works-for-indeed-and-can-work-for-you">Status works for Indeed and can work for you</h2>
<p>The <a href="https://github.com/indeedeng/status">Status</a> library is an integral part of the systems that we develop and run at Indeed. We use Status to:</p>
<ul>
<li>quickly fail over application instances and data centers</li>
<li>detect when a deploy is going to fail before the code reaches a high traffic data center</li>
<li>keep our applications fast by failing requests quickly, rather than doing work we know will fail</li>
<li>keep our sites available by ensuring that only healthy instances of our applications service requests</li>
</ul>
<p>To get started with Status, read our <a href="http://opensource.indeedeng.io/status/docs/quick-start/">quick start guide</a> and take a look at the <a href="https://github.com/indeedeng/status/tree/master/status-samples">samples</a>.
If you need help, you can reach out to us on <a href="https://github.com/indeedeng/">GitHub</a> or <a href="https://twitter.com/indeedeng">Twitter</a>.</p>  </div> </main> <footer data-astro-cid-bvzihdzo> <p data-astro-cid-bvzihdzo>&copy; 2024&nbsp;Mya Jaye. All rights reserved.</p> <div class="social-links" data-astro-cid-yxtifmrq> <a href="https://linktr.ee/MsMyaDev" target="_blank" data-astro-cid-yxtifmrq> <span class="sr-only" data-astro-cid-yxtifmrq>Linktree</span> <svg viewBox="0 0 24 24" aria-hidden="true" width="32" height="32" data-astro-cid-yxtifmrq> <path fill="currentColor" d="M7.953 15.066c-.08.163-.08.324-.08.486.08.517.528.897 1.052.89h1.294v4.776c0 .486-.404.89-.89.89H6.577a.898.898 0 0 1-.889-.891v-4.774H.992c-.728 0-1.214-.729-.89-1.377l6.96-12.627a1.065 1.065 0 0 1 1.863 0l2.913 5.585-3.885 7.042zm15.945 0-6.96-12.627a1.065 1.065 0 0 0-1.862 0l-2.995 5.586 3.885 7.04c.081.164.081.326.081.487-.08.517-.529.897-1.052.89h-1.296v4.776c.005.49.4.887.89.89h2.914a.9.9 0 0 0 .892-.89v-4.775h4.612c.73 0 1.214-.729.89-1.377z" data-astro-cid-yxtifmrq></path> </svg> </a> <a href="https://github.com/mjpitz" target="_blank" data-astro-cid-yxtifmrq> <span class="sr-only" data-astro-cid-yxtifmrq>GitHub</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-yxtifmrq> <path fill="currentColor" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z" data-astro-cid-yxtifmrq></path> </svg> </a> <a href="https://www.linkedin.com/in/mjpitz/" target="_blank" data-astro-cid-yxtifmrq> <span class="sr-only" data-astro-cid-yxtifmrq>LinkedIn</span> <svg viewBox="0 0 50 50" aria-hidden="true" width="32" height="32" data-astro-cid-yxtifmrq> <path fill="currentColor" d="M41,4H9C6.24,4,4,6.24,4,9v32c0,2.76,2.24,5,5,5h32c2.76,0,5-2.24,5-5V9C46,6.24,43.76,4,41,4z M17,20v19h-6V20H17z M11,14.47c0-1.4,1.2-2.47,3-2.47s2.93,1.07,3,2.47c0,1.4-1.12,2.53-3,2.53C12.2,17,11,15.87,11,14.47z M39,39h-6c0,0,0-9.26,0-10 c0-2-1-4-3.5-4.04h-0.08C27,24.96,26,27.02,26,29c0,0.91,0,10,0,10h-6V20h6v2.56c0,0,1.93-2.56,5.81-2.56 c3.97,0,7.19,2.73,7.19,8.26V39z" data-astro-cid-yxtifmrq></path> </svg> </a> <a href="https://twitter.com/MsMyaDev/" target="_blank" data-astro-cid-yxtifmrq> <span class="sr-only" data-astro-cid-yxtifmrq>Twitter</span> <svg viewBox="0 0 310 310" width="32" height="32" data-astro-cid-yxtifmrq> <path fill="currentColor" d="M302.973,57.388c-4.87,2.16-9.877,3.983-14.993,5.463c6.057-6.85,10.675-14.91,13.494-23.73 c0.632-1.977-0.023-4.141-1.648-5.434c-1.623-1.294-3.878-1.449-5.665-0.39c-10.865,6.444-22.587,11.075-34.878,13.783 c-12.381-12.098-29.197-18.983-46.581-18.983c-36.695,0-66.549,29.853-66.549,66.547c0,2.89,0.183,5.764,0.545,8.598 C101.163,99.244,58.83,76.863,29.76,41.204c-1.036-1.271-2.632-1.956-4.266-1.825c-1.635,0.128-3.104,1.05-3.93,2.467 c-5.896,10.117-9.013,21.688-9.013,33.461c0,16.035,5.725,31.249,15.838,43.137c-3.075-1.065-6.059-2.396-8.907-3.977 c-1.529-0.851-3.395-0.838-4.914,0.033c-1.52,0.871-2.473,2.473-2.513,4.224c-0.007,0.295-0.007,0.59-0.007,0.889 c0,23.935,12.882,45.484,32.577,57.229c-1.692-0.169-3.383-0.414-5.063-0.735c-1.732-0.331-3.513,0.276-4.681,1.597 c-1.17,1.32-1.557,3.16-1.018,4.84c7.29,22.76,26.059,39.501,48.749,44.605c-18.819,11.787-40.34,17.961-62.932,17.961 c-4.714,0-9.455-0.277-14.095-0.826c-2.305-0.274-4.509,1.087-5.294,3.279c-0.785,2.193,0.047,4.638,2.008,5.895 c29.023,18.609,62.582,28.445,97.047,28.445c67.754,0,110.139-31.95,133.764-58.753c29.46-33.421,46.356-77.658,46.356-121.367 c0-1.826-0.028-3.67-0.084-5.508c11.623-8.757,21.63-19.355,29.773-31.536c1.237-1.85,1.103-4.295-0.33-5.998 C307.394,57.037,305.009,56.486,302.973,57.388z" data-astro-cid-yxtifmrq></path> </svg> </a> <a href="https://youtube.com/@Ms-Mya-Dev/" target="_blank" data-astro-cid-yxtifmrq> <span class="sr-only" data-astro-cid-yxtifmrq>YouTube</span> <svg viewBox="0 0 310 310" width="32" height="32" data-astro-cid-yxtifmrq> <g data-astro-cid-yxtifmrq> <path fill="currentColor" d="M297.917,64.645c-11.19-13.302-31.85-18.728-71.306-18.728H83.386c-40.359,0-61.369,5.776-72.517,19.938   C0,79.663,0,100.008,0,128.166v53.669c0,54.551,12.896,82.248,83.386,82.248h143.226c34.216,0,53.176-4.788,65.442-16.527   C304.633,235.518,310,215.863,310,181.835v-53.669C310,98.471,309.159,78.006,297.917,64.645z M199.021,162.41l-65.038,33.991   c-1.454,0.76-3.044,1.137-4.632,1.137c-1.798,0-3.592-0.484-5.181-1.446c-2.992-1.813-4.819-5.056-4.819-8.554v-67.764   c0-3.492,1.822-6.732,4.808-8.546c2.987-1.814,6.702-1.938,9.801-0.328l65.038,33.772c3.309,1.718,5.387,5.134,5.392,8.861   C204.394,157.263,202.325,160.684,199.021,162.41z" data-astro-cid-yxtifmrq></path> </g> </svg> </a> <a href="/rss.xml" target="_blank" data-astro-cid-yxtifmrq> <span class="sr-only" data-astro-cid-yxtifmrq>RSS</span> <svg viewBox="0 0 16 16" aria-hidden="true" width="32" height="32" data-astro-cid-yxtifmrq> <path fill="currentColor" d="M1,5v2c1.081,0,2.128,0.211,3.113,0.628c0.952,0.403,1.808,0.98,2.543,1.715s1.312,1.591,1.715,2.543 C8.789,12.872,9,13.919,9,15h2C11,9.477,6.523,5,1,5z M4,10c-1.105,0-2,0.895-2,2s0.895,2,2,2s2-0.895,2-2S5.105,10,4,10z M1,1v2 c1.621,0,3.192,0.317,4.67,0.942c1.429,0.604,2.712,1.47,3.815,2.573c1.103,1.103,1.968,2.386,2.573,3.815 C12.683,11.808,13,13.379,13,15h2C15,7.268,8.732,1,1,1z" data-astro-cid-yxtifmrq></path> </svg> </a> </div>  </footer> </body></html>